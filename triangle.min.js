TRIANGLE||(TRIANGLE={});var TRIANGLE={init:function init(a){var b=a.querySelector("canvas");params={color:a.dataset.trianglecolor,cross:a.dataset.trianglecross,distance:a.dataset.triangledistance,start:a.dataset.trianglestart,end:a.dataset.triangleend},TRIANGLE.injectCSS(a,b),a.style.top=TRIANGLE.getCanvasPosition()+"px",paper.install(window),paper.setup(b),TRIANGLE.variables(a),TRIANGLE.generateQuadrantCoordinates(),TRIANGLE.makeCross(),TRIANGLE.makeQuadrants(),TRIANGLE.makeTriangle(),TRIANGLE.events(a),TRIANGLE.onPageScroll(),view.draw(),setTimeout(function(){a.style.transition="transform 1s cubic-bezier(.17,.67,.5,1)"},100)},injectCSS:function injectCSS(a,b){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(d){"use strict";if(null==d)throw new TypeError("Cannot convert undefined or null to object");for(var h,f=Object(d),g=1;g<arguments.length;g++)if(h=arguments[g],null!=h)for(var j in h)Object.prototype.hasOwnProperty.call(h,j)&&(f[j]=h[j]);return f},writable:!0,configurable:!0}),divStyle={width:"100%",height:"100vh",pointerEvents:"none",position:"absolute",zIndex:"7",top:0,willChange:"transform"},canvasStyle={position:"absolute",width:"100%",height:"120%",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},Object.assign(a.style,divStyle),Object.assign(b.style,canvasStyle)},variables:function variables(a){canvasWidth=view.size.width,canvasHeight=view.size.height,halfWidth=canvasWidth/2,halfHeight=canvasHeight/2,quadrants=[],quadrantPaths=[],crossPath={},trianglePath={},triangleElement=a,startElement=document.querySelector("[data-sectionid=\""+params.start+"\"]"),endElement=document.querySelector("[data-sectionid=\""+params.end+"\"]"),startElementInitialPos=TRIANGLE.getCoords(startElement).top,endElementInitialPos=TRIANGLE.getCoords(endElement).top},events:function events(){var b=[];trianglePath.segments.forEach(function(c,d){var e;do e=new Point.random().multiply(view.size);while(!quadrantPaths[d].contains(e)||crossPath.contains(e));b.push(e)}),view.onFrame=function(){var d=[];trianglePath.segments.forEach(function(e,f){var g=e.point;d.push(b[f].subtract(e.point)),g.x+=d[f].x/90,g.y+=d[f].y/90,5>d[f].length&&(b.length=0,trianglePath.segments.forEach(function(h,j){var k;do k=new Point.random().multiply(view.size);while(!quadrantPaths[j].contains(k)||crossPath.contains(k)||!h.point.isClose(k,params.distance));b.push(k)}))})},view.onMouseMove=TRIANGLE.onMouseMove,window.addEventListener("scroll",TRIANGLE.onPageScroll)},onMouseMove:function onMouseMove(a){trianglePath.segments.forEach(function(b){var c=b.point,d=a.point,e=a.delta||{x:0,y:0},f={x:d.x-e.x,y:d.y-e.y},g=c.getDistance(f)>c.getDistance(d),h=c.getDistance(d)/20;c.isClose(d,30)?(c.x+=e.x/h/4,c.y+=e.y/h/4):(c.x+=e.x/h,c.y+=e.y/h)})},onPageScroll:function onPageScroll(){var a=startElement.getBoundingClientRect().top,b=endElement.getBoundingClientRect().top,c=window.innerHeight;0>=a&&0<=b?triangleElement.style.transform="translate3d(0,"+(startElementInitialPos-a)+"px,0)":0<a&&a<c||0>b?(0<a&&a<c&&(triangleElement.style.transform="translate3d(0,"+startElementInitialPos+"px,0)"),0>b&&(triangleElement.style.transform="translate3d(0,"+endElementInitialPos+"px,0)")):triangleElement.style.transform="translate3d(0,"+startElementInitialPos+"px,0)"},generateQuadrantCoordinates:function generateQuadrantCoordinates(){quadrants.push({x1:0,y1:0,x2:halfWidth,y2:halfHeight}),quadrants.push({x1:halfWidth,y1:0,x2:2*canvasWidth,y2:halfHeight}),quadrants.push({x1:halfWidth,y1:halfHeight,x2:canvasWidth,y2:canvasHeight}),quadrants.push({x1:0,y1:halfHeight,x2:halfWidth,y2:canvasHeight});var a=Math.floor(4*Math.random());quadrants.splice(a,1)},makeCross:function makeCross(){var a=new Rectangle(new Point(halfWidth-halfWidth*params.cross,0),new Point(halfWidth+canvasWidth*params.cross/2,canvasHeight)),b=new Rectangle(new Point(0,halfHeight-halfHeight*params.cross),new Point(canvasWidth,halfHeight+canvasHeight*params.cross/2)),c=new Path.Rectangle(a),d=new Path.Rectangle(b);crossPath=new CompoundPath({children:[d,c]})},makeQuadrants:function makeQuadrants(){quadrants.forEach(function(a){var b=new Rectangle(new Point(a.x1,a.y1),new Point(a.x2,a.y2)),c=new Path.Rectangle(b);quadrantPaths.push(c)})},makeTriangle:function makeTriangle(){var a=[];quadrantPaths.forEach(function(b){var c;do c=new Point.random().multiply(view.size);while(!b.contains(c)||crossPath.contains(c));a.push(c)}),trianglePath=new Path({segments:[].concat(a),strokeColor:params.color,strokeWidth:.5,strokeCap:"round",closed:!0})},getCanvasPosition:function getCanvasPosition(){document.querySelector("[data-sectionid=\""+params.start+"\"]").getBoundingClientRect().top-document.body.getBoundingClientRect().top},getCoords:function getCoords(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,j=b.top+e-g,k=b.left+f-h;return{top:Math.round(j),left:Math.round(k)}},getRandomColor:function getRandomColor(){for(var a="#",b=0;6>b;b++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a}};window.onload=function(){for(var a=document.querySelectorAll(".triangle"),b=0;b<a.length;b++)TRIANGLE.init(a[b])};
